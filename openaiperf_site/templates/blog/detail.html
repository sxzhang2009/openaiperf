{% extends "base.html" %}

{% block title %}{{ row.title }} · OpenAIPerf{% endblock %}

{% block content %}
<section class="py-20">
  <div class="max-w-4xl mx-auto px-4">
    <article class="soft-grad border rounded-2xl p-6 shadow-sm">
      <h1 class="text-2xl md:text-3xl font-bold leading-tight text-slate-900">{{ row.title }}</h1>
      <p class="text-slate-500 text-sm mt-2">{{ row.created_at.strftime('%B %d, %Y') }}</p>
      <div class="mt-8 text-slate-700 prose lg:prose-xl max-w-none">
        {{ row.content | safe }}
      </div>
    </article>

    <div class="mt-12">
      <h2 class="text-2xl font-bold">Comments</h2>
      {% if request.session.user %}
      <form method="post" action="{{ url_for('add_comment', blog_id=row.id) }}" class="mt-4">
        <div class="mb-4">
          <textarea 
            class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none" 
            name="content" 
            rows="4" 
            placeholder="写下你的评论..."
            required
          ></textarea>
        </div>
        <button type="submit" class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">提交评论</button>
      </form>
      {% else %}
      <p class="mt-4">You must be logged in to comment. <a href="/login" class="text-indigo-600">Login</a></p>
      {% endif %}

      <div class="mt-8 space-y-4">
        {% for comment in comments %}
        <div class="soft-grad border rounded-2xl p-4">
          <p class="font-semibold">{{ comment.username }}</p>
          <p class="text-sm text-slate-500">{{ comment.created_at.strftime('%B %d, %Y') }}</p>
          <p class="mt-2">{{ comment.content }}</p>
        </div>
        {% else %}
        <p>No comments yet.</p>
        {% endfor %}
      </div>
    </div>
  </div>
</section>
{% endblock %}
